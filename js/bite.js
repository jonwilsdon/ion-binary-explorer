var BITE=(()=>{var g=(a,t)=>()=>(t||(t={exports:{}},a(t.exports,t)),t.exports);var T=g(z=>{"use strict";var Y=class{constructor(){}nextByte(){return null}skipBytes(t){return null}setPosition(t){return null}atEnd(t){}size(){}readVarUInt(){let t=0,e=0,i;do{if(i=this.nextByte(),i===null)return this.skipBytes(-1*t),null;t++,t===5&&(e=BigInt(e)),t>4?e=e<<7n|BigInt(i&127):e=e<<7|i&127}while(!(i&128));if(t>4)if(e>Number.MAX_SAFE_INTEGER){let s=`VarUInt > 4 bytes and magnitude (${e}) > Number.MAX_SAFE_INTEGER (${Number.MAX_SAFE_INTEGER}); not all readers support large VarUInts.`}else{let s=`VarUInt > 4 bytes and magnitude (${e}) <= Number.MAX_SAFE_INTEGER (${Number.MAX_SAFE_INTEGER}); not all readers support large VarUInts.`;e=Number(e)}return{numBytesRead:t,magnitude:e}}readUInt(t){let e=0,i=0,s;do{if(s=this.nextByte(),s===null)return this.skipBytes(-1*e),null;e++,e===4&&(i=BigInt(i)),e>3?i=i<<8n|BigInt(s):i=i<<8|s}while(e<t);if(e>4)if(i>Number.MAX_SAFE_INTEGER){let l=`UInt > 4 bytes and magnitude (${i}) > Number.MAX_SAFE_INTEGER (${Number.MAX_SAFE_INTEGER}); not all readers support large UInts.`}else{let l=`UInt > 4 bytes and magnitude (${i}) <= Number.MAX_SAFE_INTEGER (${Number.MAX_SAFE_INTEGER}); not all readers support large UInts.`;i=Number(i)}return{numBytesRead:e,magnitude:i}}readVarInt(){let t=0,e=0,i,s;do{if(s=this.nextByte(),s===null)return this.skipBytes(-1*t),null;t++,t===5&&(e=BigInt(e)),t===1?(i=(s&64)!=0,e=s&63):t>4?e=e<<7n|BigInt(s&127):e=e<<7|s&127}while(!(s&128));if(t>4)if(e>Number.MAX_SAFE_INTEGER){let l=`VarInt > 4 bytes and magnitude (${e}) > Number.MAX_SAFE_INTEGER (${Number.MAX_SAFE_INTEGER}); not all readers support large VarInts.`}else{let l=`VarInt > 4 bytes and magnitude (${e}) <= Number.MAX_SAFE_INTEGER (${Number.MAX_SAFE_INTEGER}); not all readers support large VarInts.`;e=Number(e)}return{numBytesRead:t,magnitude:i===!0?-e:e,isNegative:i}}readInt(t){let e=0,i=0,s,l;do{if(l=this.nextByte(),l===null)return this.skipBytes(-1*e),null;e++,e===4&&(i=BigInt(i)),e===1?(s=(l&128)!=0,i=i<<7|l&127):e>3?i=i<<8n|BigInt(l):i=i<<8|l}while(e<t);if(e>4)if(i>Number.MAX_SAFE_INTEGER){let r=`Int > 4 bytes and magnitude (${i}) > Number.MAX_SAFE_INTEGER (${Number.MAX_SAFE_INTEGER}); not all readers support large Ints.`}else{let r=`Int > 4 bytes and magnitude (${i}) <= Number.MAX_SAFE_INTEGER (${Number.MAX_SAFE_INTEGER}); not all readers support large Ints.`;i=Number(i)}return{numBytesRead:e,magnitude:s===!0?-i:i,isNegative:s}}};z.ByteReader=Y});var M=g(Z=>{"use strict";var Lt=T(),H=class extends Lt.ByteReader{#i=null;#t=null;#s=0;constructor(){super()}loadBuffer(t){if(this.#i=t,this.#i===null||this.#i===void 0)throw new Error(`called with a ${this.#i} buffer.`);if(this.#i instanceof ArrayBuffer)this.#t=new Uint8Array(this.#i);else if(this.#i instanceof Uint8Array)this.#t=this.#i;else throw new Error("ByteBufferReader loadBuffer() called with an unsupported buffer type.");return this.#t.length}nextByte(){if(this.atEnd())return null;if(typeof this.#s=="bigint"){if(this.#s+1n>this.#t.length)return null}else if(this.#s+1>this.#t.length)return null;let t=this.#t[this.#s];return this.#s++,t}skipBytes(t){this.#s+=t}setPosition(t){this.#s=t}atEnd(t){if(typeof t=="bigint"){if(t===BigInt(this.#t.length))return!0;if(t>BigInt(this.#t.length))return null}else{if(t===this.#t.length)return!0;if(t>this.#t.length)return null}return!1}rawBytes(t,e){return this.#t.slice(t,t+e)}get positionInBuffer(){return this.#s}get size(){return this.#t.length}};Z.ByteBufferReader=H});var I=g(J=>{"use strict";var W={null:0,bool:1,"int+":2,"int-":3,float:4,decimal:5,timestamp:6,symbol:7,string:8,clob:9,blob:10,list:11,sexp:12,struct:13,annotation:14,reserved:15,bvm:16,nop:17,numTypes:18,isContainer:function(a){return a===this.list||a===this.sexp||a===this.struct},isScalar:function(a){return a===this.null||a===this.bool||a===this["int+"]||a===this["int-"]||a===this.float||a===this.decimal||a===this.timestamp||a===this.symbol||a===this.string||a===this.clob||a===this.blob},nameFromType:function(a){return K[a]}},K=new Array(W.numTypes);for(let[a,t]of Object.entries(W))a!=="numTypes"&&(K[t]=a);J.IonTypes=W});var L=g(Q=>{"use strict";var Vt=T(),n=I().IonTypes,tt=class{#i=[()=>({type:n.nop,length:0,isNull:!1}),()=>({type:n.nop,length:1,isNull:!1}),()=>({type:n.nop,length:2,isNull:!1}),()=>({type:n.nop,length:3,isNull:!1}),()=>({type:n.nop,length:4,isNull:!1}),()=>({type:n.nop,length:5,isNull:!1}),()=>({type:n.nop,length:6,isNull:!1}),()=>({type:n.nop,length:7,isNull:!1}),()=>({type:n.nop,length:8,isNull:!1}),()=>({type:n.nop,length:9,isNull:!1}),()=>({type:n.nop,length:10,isNull:!1}),()=>({type:n.nop,length:11,isNull:!1}),()=>({type:n.nop,length:12,isNull:!1}),()=>({type:n.nop,length:13,isNull:!1}),()=>({type:n.nop,length:14,isNull:!1}),()=>({type:n.null,length:0,isNull:!0}),()=>({type:n.bool,length:0,isNull:!1,bool:!1}),()=>({type:n.bool,length:0,isNull:!1,bool:!0}),()=>this.#e("0x12"),()=>this.#e("0x13"),()=>this.#e("0x14"),()=>this.#e("0x15"),()=>this.#e("0x16"),()=>this.#e("0x17"),()=>this.#e("0x18"),()=>this.#e("0x19"),()=>this.#e("0x1a"),()=>this.#e("0x1b"),()=>this.#e("0x1c"),()=>this.#e("0x1d"),()=>this.#e("0x1e"),()=>({type:n.bool,length:0,isNull:!0}),()=>({type:n["int+"],length:0,isNull:!1}),()=>({type:n["int+"],length:1,isNull:!1}),()=>({type:n["int+"],length:2,isNull:!1}),()=>({type:n["int+"],length:3,isNull:!1}),()=>({type:n["int+"],length:4,isNull:!1}),()=>({type:n["int+"],length:5,isNull:!1}),()=>({type:n["int+"],length:6,isNull:!1}),()=>({type:n["int+"],length:7,isNull:!1}),()=>({type:n["int+"],length:8,isNull:!1}),()=>({type:n["int+"],length:9,isNull:!1}),()=>({type:n["int+"],length:10,isNull:!1}),()=>({type:n["int+"],length:11,isNull:!1}),()=>({type:n["int+"],length:12,isNull:!1}),()=>({type:n["int+"],length:13,isNull:!1}),()=>({type:n["int+"],length:14,isNull:!1}),()=>({type:n["int+"],length:0,isNull:!0}),()=>this.#e("0x30"),()=>({type:n["int-"],length:1,isNull:!1}),()=>({type:n["int-"],length:2,isNull:!1}),()=>({type:n["int-"],length:3,isNull:!1}),()=>({type:n["int-"],length:4,isNull:!1}),()=>({type:n["int-"],length:5,isNull:!1}),()=>({type:n["int-"],length:6,isNull:!1}),()=>({type:n["int-"],length:7,isNull:!1}),()=>({type:n["int-"],length:8,isNull:!1}),()=>({type:n["int-"],length:9,isNull:!1}),()=>({type:n["int-"],length:10,isNull:!1}),()=>({type:n["int-"],length:11,isNull:!1}),()=>({type:n["int-"],length:12,isNull:!1}),()=>({type:n["int-"],length:13,isNull:!1}),()=>({type:n["int-"],length:14,isNull:!1}),()=>({type:n["int-"],length:0,isNull:!0}),()=>({type:n.float,length:0,isNull:!1}),()=>this.#e("0x41"),()=>this.#e("0x42"),()=>this.#e("0x43"),()=>({type:n.float,length:4,isNull:!1}),()=>this.#e("0x45"),()=>this.#e("0x46"),()=>this.#e("0x47"),()=>({type:n.float,length:8,isNull:!1}),()=>this.#e("0x49"),()=>this.#e("0x4a"),()=>this.#e("0x4b"),()=>this.#e("0x4c"),()=>this.#e("0x4d"),()=>this.#e("0x4e"),()=>({type:n.float,length:0,isNull:!0}),()=>({type:n.decimal,length:0,isNull:!1}),()=>({type:n.decimal,length:1,isNull:!1}),()=>({type:n.decimal,length:2,isNull:!1}),()=>({type:n.decimal,length:3,isNull:!1}),()=>({type:n.decimal,length:4,isNull:!1}),()=>({type:n.decimal,length:5,isNull:!1}),()=>({type:n.decimal,length:6,isNull:!1}),()=>({type:n.decimal,length:7,isNull:!1}),()=>({type:n.decimal,length:8,isNull:!1}),()=>({type:n.decimal,length:9,isNull:!1}),()=>({type:n.decimal,length:10,isNull:!1}),()=>({type:n.decimal,length:11,isNull:!1}),()=>({type:n.decimal,length:12,isNull:!1}),()=>({type:n.decimal,length:13,isNull:!1}),()=>({type:n.decimal,length:14,isNull:!1}),()=>({type:n.decimal,length:0,isNull:!0}),()=>this.#e("0x60"),()=>this.#e("0x61"),()=>({type:n.timestamp,length:2,isNull:!1}),()=>({type:n.timestamp,length:3,isNull:!1}),()=>({type:n.timestamp,length:4,isNull:!1}),()=>({type:n.timestamp,length:5,isNull:!1}),()=>({type:n.timestamp,length:6,isNull:!1}),()=>({type:n.timestamp,length:7,isNull:!1}),()=>({type:n.timestamp,length:8,isNull:!1}),()=>({type:n.timestamp,length:9,isNull:!1}),()=>({type:n.timestamp,length:10,isNull:!1}),()=>({type:n.timestamp,length:11,isNull:!1}),()=>({type:n.timestamp,length:12,isNull:!1}),()=>({type:n.timestamp,length:13,isNull:!1}),()=>({type:n.timestamp,length:14,isNull:!1}),()=>({type:n.timestamp,length:0,isNull:!0}),()=>({type:n.symbol,length:0,isNull:!1}),()=>({type:n.symbol,length:1,isNull:!1}),()=>({type:n.symbol,length:2,isNull:!1}),()=>({type:n.symbol,length:3,isNull:!1}),()=>({type:n.symbol,length:4,isNull:!1}),()=>({type:n.symbol,length:5,isNull:!1}),()=>({type:n.symbol,length:6,isNull:!1}),()=>({type:n.symbol,length:7,isNull:!1}),()=>({type:n.symbol,length:8,isNull:!1}),()=>({type:n.symbol,length:9,isNull:!1}),()=>({type:n.symbol,length:10,isNull:!1}),()=>({type:n.symbol,length:11,isNull:!1}),()=>({type:n.symbol,length:12,isNull:!1}),()=>({type:n.symbol,length:13,isNull:!1}),()=>({type:n.symbol,length:14,isNull:!1}),()=>({type:n.symbol,length:0,isNull:!0}),()=>({type:n.string,length:0,isNull:!1}),()=>({type:n.string,length:1,isNull:!1}),()=>({type:n.string,length:2,isNull:!1}),()=>({type:n.string,length:3,isNull:!1}),()=>({type:n.string,length:4,isNull:!1}),()=>({type:n.string,length:5,isNull:!1}),()=>({type:n.string,length:6,isNull:!1}),()=>({type:n.string,length:7,isNull:!1}),()=>({type:n.string,length:8,isNull:!1}),()=>({type:n.string,length:9,isNull:!1}),()=>({type:n.string,length:10,isNull:!1}),()=>({type:n.string,length:11,isNull:!1}),()=>({type:n.string,length:12,isNull:!1}),()=>({type:n.string,length:13,isNull:!1}),()=>({type:n.string,length:14,isNull:!1}),()=>({type:n.string,length:0,isNull:!0}),()=>({type:n.clob,length:0,isNull:!1}),()=>({type:n.clob,length:1,isNull:!1}),()=>({type:n.clob,length:2,isNull:!1}),()=>({type:n.clob,length:3,isNull:!1}),()=>({type:n.clob,length:4,isNull:!1}),()=>({type:n.clob,length:5,isNull:!1}),()=>({type:n.clob,length:6,isNull:!1}),()=>({type:n.clob,length:7,isNull:!1}),()=>({type:n.clob,length:8,isNull:!1}),()=>({type:n.clob,length:9,isNull:!1}),()=>({type:n.clob,length:10,isNull:!1}),()=>({type:n.clob,length:11,isNull:!1}),()=>({type:n.clob,length:12,isNull:!1}),()=>({type:n.clob,length:13,isNull:!1}),()=>({type:n.clob,length:14,isNull:!1}),()=>({type:n.clob,length:0,isNull:!0}),()=>({type:n.blob,length:0,isNull:!1}),()=>({type:n.blob,length:1,isNull:!1}),()=>({type:n.blob,length:2,isNull:!1}),()=>({type:n.blob,length:3,isNull:!1}),()=>({type:n.blob,length:4,isNull:!1}),()=>({type:n.blob,length:5,isNull:!1}),()=>({type:n.blob,length:6,isNull:!1}),()=>({type:n.blob,length:7,isNull:!1}),()=>({type:n.blob,length:8,isNull:!1}),()=>({type:n.blob,length:9,isNull:!1}),()=>({type:n.blob,length:10,isNull:!1}),()=>({type:n.blob,length:11,isNull:!1}),()=>({type:n.blob,length:12,isNull:!1}),()=>({type:n.blob,length:13,isNull:!1}),()=>({type:n.blob,length:14,isNull:!1}),()=>({type:n.blob,length:0,isNull:!0}),()=>({type:n.list,length:0,isNull:!1}),()=>({type:n.list,length:1,isNull:!1}),()=>({type:n.list,length:2,isNull:!1}),()=>({type:n.list,length:3,isNull:!1}),()=>({type:n.list,length:4,isNull:!1}),()=>({type:n.list,length:5,isNull:!1}),()=>({type:n.list,length:6,isNull:!1}),()=>({type:n.list,length:7,isNull:!1}),()=>({type:n.list,length:8,isNull:!1}),()=>({type:n.list,length:9,isNull:!1}),()=>({type:n.list,length:10,isNull:!1}),()=>({type:n.list,length:11,isNull:!1}),()=>({type:n.list,length:12,isNull:!1}),()=>({type:n.list,length:13,isNull:!1}),()=>({type:n.list,length:14,isNull:!1}),()=>({type:n.list,length:0,isNull:!0}),()=>({type:n.sexp,length:0,isNull:!1}),()=>({type:n.sexp,length:1,isNull:!1}),()=>({type:n.sexp,length:2,isNull:!1}),()=>({type:n.sexp,length:3,isNull:!1}),()=>({type:n.sexp,length:4,isNull:!1}),()=>({type:n.sexp,length:5,isNull:!1}),()=>({type:n.sexp,length:6,isNull:!1}),()=>({type:n.sexp,length:7,isNull:!1}),()=>({type:n.sexp,length:8,isNull:!1}),()=>({type:n.sexp,length:9,isNull:!1}),()=>({type:n.sexp,length:10,isNull:!1}),()=>({type:n.sexp,length:11,isNull:!1}),()=>({type:n.sexp,length:12,isNull:!1}),()=>({type:n.sexp,length:13,isNull:!1}),()=>({type:n.sexp,length:14,isNull:!1}),()=>({type:n.sexp,length:0,isNull:!0}),()=>({type:n.struct,length:0,isNull:!1}),()=>({type:n.struct,length:14,isNull:!1}),()=>({type:n.struct,length:2,isNull:!1}),()=>({type:n.struct,length:3,isNull:!1}),()=>({type:n.struct,length:4,isNull:!1}),()=>({type:n.struct,length:5,isNull:!1}),()=>({type:n.struct,length:6,isNull:!1}),()=>({type:n.struct,length:7,isNull:!1}),()=>({type:n.struct,length:8,isNull:!1}),()=>({type:n.struct,length:9,isNull:!1}),()=>({type:n.struct,length:10,isNull:!1}),()=>({type:n.struct,length:11,isNull:!1}),()=>({type:n.struct,length:12,isNull:!1}),()=>({type:n.struct,length:13,isNull:!1}),()=>({type:n.struct,length:14,isNull:!1}),()=>({type:n.struct,length:0,isNull:!0}),()=>({type:n.bvm,length:3,isNull:!1}),()=>this.#e("0xe1"),()=>this.#e("0xe2"),()=>({type:n.annotation,length:3,isNull:!1}),()=>({type:n.annotation,length:4,isNull:!1}),()=>({type:n.annotation,length:5,isNull:!1}),()=>({type:n.annotation,length:6,isNull:!1}),()=>({type:n.annotation,length:7,isNull:!1}),()=>({type:n.annotation,length:8,isNull:!1}),()=>({type:n.annotation,length:9,isNull:!1}),()=>({type:n.annotation,length:10,isNull:!1}),()=>({type:n.annotation,length:11,isNull:!1}),()=>({type:n.annotation,length:12,isNull:!1}),()=>({type:n.annotation,length:13,isNull:!1}),()=>({type:n.annotation,length:14,isNull:!1}),()=>this.#e("0xef"),()=>this.#e("0xf0"),()=>this.#e("0xf1"),()=>this.#e("0xf2"),()=>this.#e("0xf3"),()=>this.#e("0xf4"),()=>this.#e("0xf5"),()=>this.#e("0xf6"),()=>this.#e("0xf7"),()=>this.#e("0xf8"),()=>this.#e("0xf9"),()=>this.#e("0xfa"),()=>this.#e("0xfb"),()=>this.#e("0xfc"),()=>this.#e("0xfd"),()=>this.#e("0xfe"),()=>this.#e("0xff")];#t;#s;#e=t=>{throw new Error(`Invalid Ion T/L pair ${t}.`)};constructor(t){if(!(t instanceof Vt.ByteReader))throw new Error("expected byteReader to be a ByteReader");this.#t=t}readTypeAndLength(t,e){if(!Number.isInteger(t)||t<0)throw new Error("positionToSet is not a positive integer");this.#t.setPosition(t);let i=this.#t.nextByte();if(i===null)return null;if(i===void 0)throw new Error("typeAndLengthyByte is undefined");let s,l=!1;switch(e){case"1_0":s=this.#i;break;case"bvm":s=this.#i,l=!0;break;default:throw new Error("unknown context")}let r=s[i]();if(r.type===n.bvm)r.majorVersion=this.#t.nextByte(),r.minorVersion=this.#t.nextByte(),this.#t.skipBytes(-2);else if(l===!0)throw new Error("bvm not found");if(r.length===14){let h=this.#t.readVarUInt();if(h===null)return this.#t.skipBytes(-1),null;if(h.magnitude<14){let y="T/L pair has length and magnitude which could be represented without extra length byte"}typeof h.magnitude=="bigint"?r.length=BigInt(h.numBytesRead)+h.magnitude:r.length=h.numBytesRead+h.magnitude,r.varUIntLength=h.numBytesRead,r.isVarUInt=!0,i===209&&(r.isSortedStruct=!0)}if(r.type===n.annotation){let h=this.#t.readVarUInt();if(h===null)return r.varUIntLength!==void 0?this.#t.skipBytes(-1*(1+r.varUIntLength)):this.#t.skipBytes(-1),null;r.annotationsLength=h.magnitude,r.annotationsVarUIntLength=h.numBytesRead}return r}readFieldName(t){return this.#t.setPosition(t),this.#t.readVarUInt()}setPosition(t){this.#t.setPosition(t)}};Q.TypeDescriptorReader=tt});var G=g(V=>{"use strict";function Dt(a,t,e,i,s,l,r){return[a,t,e,i,s,l,r]}function Ut(a){return Array.isArray(a)&&a.length===7}function _t(a){if(a[6]===void 0||a[6]===null)return a[6];if(a[6]<=a[0]+a[1])throw new Error(`ElementReference nextElementReference absolute next offset (${a[6]}) <= stream offset + relative offset (${a[0]} + ${a[1]})`);return[a[0],a[6]-a[0],a[2],a[3]-(a[6]-a[1]-a[0]),a[4],a[5],void 0]}function Ft(a){return a[0]+a[1]}V.createElementReference=Dt;V.isElementReference=Ut;V.nextElementReference=_t;V.absoluteOffset=Ft});var w=g(et=>{"use strict";var{IonTypes:b}=I(),R=G(),{TypeDescriptorReader:ce}=L(),it=class{#i;#t;#s;#e;#l=!1;#r=!1;#o;#u;#n;#a=0;#h=0;#p=0;#g=0;#y=0;#d=0;#f=0;#m=null;#b=null;#c=!1;#N=!1;#E=null;#I=()=>{this.#i=void 0,this.#t=void 0,this.#s=void 0,this.#e=void 0,this.#l=!1,this.#r=!1,this.#o=void 0,this.#u=void 0,this.#n=void 0,this.#a=0,this.#h=0,this.#p=0,this.#g=0,this.#y=0,this.#d=0,this.#f=0,this.#m=null,this.#b=null,this.#c=!1,this.#N=!1};#x=t=>{this.#n=t,this.#s=[]};constructor(t){if(!R.isElementReference(t))throw new Error(`IonElement constructor passed ${t} instead of ElementReference.`);this.#x(t)}toString(){return`{ #reference: ${this.#n},
              #type: ${this.#i}, 
              #isSystemElement: ${this.#c},
              #isNull: ${this.#t},
              #isLocalSymbolTable: ${this.#l},
              #isSharedSymbolTable: ${this.#r},
              #annotations: ${this.#s},
              #length: ${this.#a},
              #varUIntLength: ${this.#h},
              #fieldNameVarUIntLength: ${this.#f},
              #fieldNameSymbolID: ${this.#e},
              #annotationsLength: ${this.#y},
              #annotationsVarUIntLength: ${this.#d},
              #lengthWithoutAnnotations: ${this.#p},
              #contains: ${this.#m},
              bytePositionOfRepresentation: ${this.bytePositionOfRepresentation},
              isContainer: ${this.isContainer} }`}repurpose(t){if(!R.isElementReference(t))throw new Error(`IonElement repurpose passed ${t} instead of ElementReference.`);this.#I(),this.#x(t)}reference(){return this.#n}readTypeDescriptor(t,e){let i=this.#n[1],s;if(this.#n[4]!==null&&this.#n[5]===b.struct){if(s=t.readFieldName(i),s===null)return null;i+=s.numBytesRead}let l=t.readTypeAndLength(i,e);if(l===null)return t.setPosition(this.#n[1]),null;this.#a=l.length||0;let r;if(l.type===b.annotation){if(r=l,!Number.isInteger(r.annotationsVarUIntLength)||!Number.isInteger(r.annotationsLength))throw new Error("Annotation missing 'annot_length' field data.");if(r.annotationsLength===0)throw new Error("'annot_length' field must be greater than zero.");let p=r.annotationsLength,E=i+1+(r.varUIntLength||0)+r.annotationsVarUIntLength,o;do{if(o=t.readFieldName(E),o===null)return t.setPosition(this.#n[1]),null;this.#s.push(o),E+=o.numBytesRead,p-=o.numBytesRead}while(p>0);let u=this.#s[0],c=i+1+(r.varUIntLength||0)+r.annotationsVarUIntLength+r.annotationsLength;if(l=t.readTypeAndLength(c,e),l===null)return t.setPosition(this.#n[1]),null;if(l.type===b.annotation)throw new Error("Annotations cannot wrap annotations.");if(l.type===b.nop)throw new Error("Annotations cannot wrap nop.");if(u.magnitude===3||u.magnitude===9){if(this.#n[2]>0)throw new Error("Symbol table annotation is not at depth 0.");if(l.type!==b.struct)throw new Error("Symbol table annotation is not wrapping struct.");u.magnitude===3?this.#l=!0:this.#r=!0,this.#E=u,this.#c=!0}l.annotationsVarUIntLength=r.annotationsVarUIntLength,l.annotationsLength=r.annotationsLength,l.varUIntLengthWithAnnotations=r.varUIntLength}if(l.type===b.bvm){if(this.#n[2]!==0)throw new Error(`BVM encountered at depth ${this.#n[2]}`);this.#c=!0,this.#o=l.majorVersion,this.#u=l.minorVersion}if(l.type===b.nop&&(this.#c=!0),l.type===b.struct&&l.isSortedStruct&&(this.#N=!0,l.length-l.varUIntLength==0))throw new Error("Sorted struct with no length.");l.lengthWithoutAnnotations=l.length,this.#i=l.type,this.#t=l.isNull,this.#h=l.varUIntLength||0,this.#y=l.annotationsLength||0,this.#d=l.annotationsVarUIntLength||0,this.#p=l.lengthWithoutAnnotations||0,this.#g=l.varUIntLengthWithAnnotations||0,s&&(this.#e=s.magnitude,this.#f=s.numBytesRead),this.#i===b.bool&&(this.#b=l.bool);let h;typeof this.#a=="bigint"||typeof this.#f=="bigint"?h=1n+BigInt(this.#a)+BigInt(this.#f):h=1+this.#a+this.#f,b.isContainer(this.#i)&&this.#p!==0&&this.#t===!1&&(typeof h=="bigint"?this.#m=R.createElementReference(this.#n[0],this.bytePositionOfRepresentation,this.#n[2]+1,h-BigInt(this.bytePositionOfRepresentation-this.#n[1]),this.#n[1]+this.#n[0],this.#i,void 0):this.#m=R.createElementReference(this.#n[0],this.bytePositionOfRepresentation,this.#n[2]+1,h-(this.bytePositionOfRepresentation-this.#n[1]),this.#n[1]+this.#n[0],this.#i,void 0));let y;if(typeof h=="bigint"||typeof this.#n[3]=="bigint"){if(y=BigInt(this.#n[3])-BigInt(h),y>0n)this.#n[6]=BigInt(this.#n[1])+BigInt(h)+BigInt(this.#n[0]);else if(y<0n)return t.setPosition(this.#n[1]),null}else if(y=this.#n[3]-h,y>0)this.#n[6]=this.#n[1]+h+this.#n[0];else if(y<0)return t.setPosition(this.#n[1]),null}get bytePositionOfRepresentation(){return this.#i===b.bvm||this.#i===b.nop||this.#p===0||this.#t?null:this.#n[1]+this.#f+(this.#y>0?1+this.#g+this.#d+this.#y:0)+1+this.#h}get bytePositionOfAnnotations(){return this.#y<=0?null:this.#n[1]+(this.#f+1+this.#g+this.#d)}get isContainer(){return b.isContainer(this.#i)}get isScalar(){return b.isScalar(this.#i)}get isNull(){return this.#t}get containsElement(){return this.#m}get nextElementReference(){return R.nextElementReference(this.#n)}get absoluteOffset(){return R.absoluteOffset(this.#n)}get relativeOffset(){return this.#n[1]}get depth(){return this.#n[2]}get container(){return this.#n[4]}get containerType(){return this.#n[5]}get totalLength(){let t;return typeof this.#a=="bigint"?t=BigInt(this.#f)+1n+this.#a:t=this.#f+1+this.#a,t}get length(){return this.#a}get lengthWithoutAnnotations(){return this.#p}get type(){return this.#i}get majorVersion(){return this.#o}get minorVersion(){return this.#u}get fieldNameSymbolID(){return this.#e}get annotations(){return this.#s}get annotationsLength(){return this.#y}get annotationsVarUIntLength(){return this.#d}get varUIntLengthWithAnnotations(){return this.#g}get varUIntLength(){return this.#h}get boolRepresentation(){return this.#b}get isSystemElement(){return this.#c}get isSorted(){return this.#N}get isLocalSymbolTable(){return this.#l}get isSharedSymbolTable(){return this.#r}get firstAnnotation(){return this.#E}get bytesRemainingAtDepth(){return this.#n[3]}get fieldNameVarUIntLength(){return this.#f}get nibblePositionStruct(){let t={},e=0;if(t.offset=this.#n[1],t.depth=this.#n[2],typeof this.totalLength=="bigint"?t.totalNibbles=this.totalLength*2n:t.totalNibbles=this.totalLength*2,this.#e===void 0)t.fieldName=null;else{let l={};l.symbolMagnitude=this.fieldNameSymbolID,l.nibbles={},l.nibbles.symbolStart=e,l.nibbles.symbolEnd=e+this.fieldNameVarUIntLength*2-1,t.fieldName=l,e=l.nibbles.symbolEnd+1}if(this.annotationsLength===0)t.annotation={};else{let l={},r={};r.type=e,e+=1,r.wrapperLengthStart=e,r.wrapperLengthEnd=e+this.#g*2,e=r.wrapperLengthEnd+1,r.annotationsLengthStart=e,r.annotationsLengthEnd=e+this.#d*2-1,e=r.annotationsLengthEnd+1,l.wrapperLengthValue=this.#a,l.lengthValue=this.annotationsLength;let h=[];for(let y of this.annotations){let p={};p.nibbles={},p.nibbles.symbolStart=e,p.nibbles.symbolEnd=e+y.numBytesRead*2-1,e=p.nibbles.symbolEnd+1,p.symbolMagnitude=y.magnitude,h.push(p)}l.nibbles=r,l.annotations=h,t.annotation=l}let i={},s={};if(s.type=e,e+=1,s.lengthStart=e,s.lengthEnd=e+this.varUIntLength*2,e=s.lengthEnd+1,e!==t.totalNibbles)if(e<t.totalNibbles)s.representationStart=e,s.representationEnd=t.totalNibbles-1;else throw new Error(`nibblePositionStruct has invalid position ${postion} out of ${t.totalNibbles} for representationLength`);return i.typeValue=this.type,i.typeName=b.nameFromType(this.type),i.lengthValue=this.lengthWithoutAnnotations-this.varUIntLength,i.totalLength=this.totalLength,i.nibbles=s,t.element=i,t}};et.IonElement=it});var P=g(X=>{"use strict";var Pt=T(),{IonElement:be}=w(),{IonTypes:B}=I(),nt=class{#i;#t;#s=function(t,e,i){i.setPosition(t);let s=i.readUInt(e).magnitude;return e>3&&s===0n||s===0,s};#e=function(t,e,i){i.setPosition(t);let s=i.readUInt(e).magnitude;if(e>3&&s===0n||s===0)throw new Error("readNegativeInt() zero not a valid negative int value.");return-s};#l=function(t,e,i){if(e!==4&&e!==8)throw new Error(`ScalarValueReader illegal float length ${e}.`);let s=new Uint8Array(e);i.setPosition(t);for(let r=0;r<e;++r)if(s[r]=i.nextByte(),s[r]===null)return i.skipBytes(-1*r),null;let l;switch(e){case 4:return l=new DataView(s.buffer),l.getFloat32(0,!1);case 8:return l=new DataView(s.buffer),l.getFloat64(0,!1);default:}};#r=function(t,e,i){i.setPosition(t);let s=i.readVarInt();if(s===null)return null;let l=e-s.numBytesRead,r;if(l<0)throw new Error("ScalarValueReader illegal coefficient length.");if(l===0)r={magnitude:0,numBytesRead:0,isNegative:!1};else{if(r=i.readInt(l),r===null)return i.skipBytes(-1*s.numBytesRead),null;r.isNegative===!1&&(r.magnitude===0||r.magnitude===0n)}return{exponent:s,coefficient:r}};#o=function(t,e,i){i.setPosition(t);let s=e,l,r,h,y,p,E,o,u,c;if(l=i.readVarInt(),l===null)return null;if(s-=l.numBytesRead,r=i.readVarUInt(),r===null)return i.skipBytes(-1*(e-s)),null;if(s-=r.numBytesRead,s>0){if(h=i.readVarUInt(),h===null)return i.skipBytes(-1*(e-s)),null;s-=h.numBytesRead}if(s>0){if(y=i.readVarUInt(),y===null)return i.skipBytes(-1*(e-s)),null;s-=y.numBytesRead}if(s>0){if(p=i.readVarUInt(),p===null)return i.skipBytes(-1*(e-s)),null;if(s-=p.numBytesRead,s>0){if(E=i.readVarUInt(),E===null)return i.skipBytes(-1*(e-s)),null;s-=E.numBytesRead}else throw new Error("ScalarValueReader hours present without minutes.")}if(s>0){if(o=i.readVarUInt(),o===null)return i.skipBytes(-1*(e-s)),null;s-=o.numBytesRead}if(s>0){if(u=i.readVarInt(),u===null)return i.skipBytes(-1*(e-s)),null;s-=u.numBytesRead}if(s>0){if(c=i.readInt(s),c===null)return i.skipBytes(-1*(e-s)),null}else u!==void 0&&(c={numBytesRead:0,magnitude:0,isNegative:!1});return{offset:l,year:r,month:h,day:y,hour:p,minute:E,second:o,fractionExponent:u,fractionCoefficient:c}};#u=function(t,e,i){if(e<1)return 0;i.setPosition(t);let s=i.readUInt(e);return s===null?null:s.magnitude};#n=function(t,e,i){let s=new Uint8Array(e);i.setPosition(t);for(let l=0;l<e;++l)if(s[l]=i.nextByte(),s[l]===null)return i.skipBytes(-1*l),null;return this.#i.decode(s)};#a=function(t,e,i){let s=new Uint8Array(e);i.setPosition(t);for(let l=0;l<e;++l)if(s[l]=i.nextByte(),s[l]===null)return i.skipBytes(-1*l),null;return s};#h;constructor(t){if(!(t instanceof Pt.ByteReader))throw new Error("ScalarValueReader expected byteReader to be a ByteReader.");this.#t=t,this.#i=new TextDecoder("utf-8"),this.#h=new Array(B.numTypes);for(let e=0;e<B.numTypes;++e)this.#h[e]=function(i,s){throw new Error(`ScalarValueReader called on ${B.nameFromType(e)}, a non-scalar.`)};this.#h[B["int+"]]=this.#s,this.#h[B["int-"]]=this.#e,this.#h[B.float]=this.#l,this.#h[B.decimal]=this.#r,this.#h[B.timestamp]=this.#o,this.#h[B.symbol]=this.#u,this.#h[B.string]=this.#n,this.#h[B.clob]=this.#a,this.#h[B.blob]=this.#a}read(t,e,i){if(this.#h[t]===void 0)throw new Error(`ScalarValueReader read() called with non-existent type ${t}.`);if(!Number.isInteger(e)||e<0)throw new Error(`ScalarValueReader read() called with invalid position ${e}.`);if(!Number.isInteger(i)||i<=0)throw new Error(`ScalarValueReader read() called with invalid length ${i}.`);return this.#h[t].apply(this,[e,i,this.#t])}},qt=(a,t)=>{if(a===void 0||t===null)throw new Error("readScalar called with no element");if(t==null)throw new Error("readScalar called with no scalarReader");return t.read(a.type,a.bytePositionOfRepresentation,a.lengthWithoutAnnotations-a.varUIntLength)};X.readScalarFromElement=qt;X.ScalarValueReader=nt});var q=g(st=>{"use strict";var Ee=I().IonTypes,Ot=!1,lt=class{#i=1e4;#t=this.#i;#s=1;#e=null;#l;#r;#o;#u;#n=t=>{this.#s+t>this.#t&&(this.#t+=this.#i,this.#l.push(new Array(this.#i)),this.#r!==void 0&&this.#r.push(new Array(this.#i)),this.#o!==void 0&&(this.#o.push(new Array(this.#i)),this.#u.push(new Array(this.#i))))};#a=t=>{let e=t-this.#i,i=1;for(;e>=this.#i;)e-=this.#i,i++;return{array:i,symbol:e}};constructor(t,e,i,s,l){if(this.#l=[new Array(this.#i)],e===!0&&(this.#r=[new Array(this.#i)]),i===!0&&(this.#o=[new Array(this.#i)],this.#u=[new Array(this.#i)]),t===!0)switch(l===void 0&&(l=0),s){case"1_0":this.addSymbol("$ion",l),this.addSymbol("$ion_1_0",l),this.addSymbol("$ion_symbol_table",l),this.addSymbol("name",l),this.addSymbol("version",l),this.addSymbol("imports",l),this.addSymbol("symbols",l),this.addSymbol("max_id",l),this.addSymbol("$ion_shared_symbol_table",l);break;case"1_1":this.addSymbol("$ion",l),this.addSymbol("$ion_1_0",l),this.addSymbol("$ion_symbol_table",l),this.addSymbol("name",l),this.addSymbol("version",l),this.addSymbol("imports",l),this.addSymbol("symbols",l),this.addSymbol("max_id",l),this.addSymbol("$ion_shared_symbol_table",l),this.addSymbol("templates",l),this.addSymbol("max_template_id",l);break;default:throw new Error(`SymbolTable passed invalid context ${s}`)}}addSymbol(t,e){if(this.#n(1),Ot===!0){let s=this.getSymbolID(t);if(s!==null)throw new Error(`SymbolTable addSymbol passed symbolValue ${t} already in table at ${s}.`)}if(this.#s<this.#i)this.#l[0][this.#s]=t,e!==void 0&&this.#r!==void 0&&(this.#r[0][this.#s]=e);else{let s=this.#a(this.#s);this.#l[s.array][s.symbol]=t,e!==void 0&&this.#r!==void 0&&(this.#r[s.array][s.symbol]=e)}let i=this.#s;return this.#s++,i}addUsage(t,e){if(!this.#o)throw new Error(`SymbolTable addUsage(${t}, ${e}) called with no usage enabled.`);if(t<this.#i)this.#o[0][t]===void 0?(this.#o[0][t]=[e],this.#u[0][t]=1):(this.#o[0][t].push(e),this.#u[0][t]++);else{let i=this.#a(this.#s);this.#o[i.array][i.symbol]===void 0?(this.#o[i.array][i.symbol]=[e],this.#u[i.array][i.symbol]=1):(this.#o[i.array][i.symbol].push(e),this.#u[i.array][i.symbol]++)}}getSymbolValue(t,e){if(t<this.#i){if(e!==void 0&&this.#r[0][t]>e)throw new Error(`${this.#r[0][t]} > ${e}`);return this.#l[0][t]}let i=this.#a(this.#s);if(e!==void 0&&this.#r[i.array][i.symbol]>e)throw new Error(`${this.#r[i.array][i.symbol]} > ${e}`);return this.#l[i.array][i.symbol]}getSymbolUsage(t){if(t<this.#i)return this.#o[0][t];let e=this.#a(this.#s);return this.#o[e.array][e.symbol]}getSymbolUsageCount(t){if(t<this.#i)return this.#u[0][t];let e=this.#a(this.#s);return this.#u[e.array][e.symbol]}getSymbolID(t){for(let e=0;e<this.#l.length;++e)for(let i=0;i<this.#l[e].length;++i)if(t===this.#l[e][i])return e*this.#i+i;return null}get symbols(){let t=[];for(let e=0;e<this.#l.length;++e)for(let i=0;i<this.#l[e].length;++i)this.#l[e][i]!==void 0&&t.push(this.#l[e][i]);return t}get meta(){let t=[];for(let e=0;e<this.#l.length;++e)for(let i=0;i<this.#l[e].length;++i)this.#l[e][i]!==void 0&&t.push(this.#r[e][i]);return t}get usage(){let t=[];for(let e=0;e<this.#l.length;++e)for(let i=0;i<this.#l[e].length;++i)this.#l[e][i]!==void 0&&t.push(this.#o[e][i]);return t}get usageCounts(){let t=[];for(let e=0;e<this.#l.length;++e)for(let i=0;i<this.#l[e].length;++i)this.#l[e][i]!==void 0&&t.push(this.#u[e][i]);return t}};st.SymbolTable=lt});var D=g(rt=>{"use strict";var $=I().IonTypes,kt=(a,t)=>{if(t==null)throw new Error("readScalar called with no scalarReader");if(!(a.type===$["int+"]||a.type===$["int-"]||a.type===$.float||a.type===$.decimal||a.type===$.timestamp||a.type===$.symbol||a.type===$.string||a.type===$.clob||a.type===$.blob))throw new Error(`readScalar called with a non-scalar type ${a.type}`);return t.read(a.type,a.bytePositionOfRepresentation,a.lengthWithoutAnnotations-a.varUIntLength)};rt.readScalarFromElement=kt});var j=g(at=>{"use strict";var Be=w().IonElement,S=I().IonTypes,ot=class{#i=10;#t={topLevelCount:0,nulls:{count:0},maxDepth:{value:null,offset:[],count:0},maxAnnotations:{value:null,offset:[],count:0},symbolTable:{local:{count:0},shared:{count:0},append:{count:0},inline:{}},templates:{}};constructor(){for(let t=0;t<S.numTypes;++t)this.#t.nulls[S.nameFromType(t)]={count:0},this.#t[S.nameFromType(t)]={byteCount:0,maxBytes:{value:null,offset:[],count:0},minBytes:{value:null,offset:[],count:0},maxDepth:{value:null,offset:[],count:0},depthCount:[],count:0}}trackElement(t,e){let i=this.#t[S.nameFromType(t.type)],s=t.lengthWithoutAnnotations,l=t.relativeOffset+(e===void 0?0:e);for(i===void 0&&console.log(t.toString()),t.depth===0&&this.#t.topLevelCount++,i.count++,i.byteCount+=s,s>i.maxBytes.value||i.maxBytes.value===null?(i.maxBytes.value=s,i.maxBytes.offset=[l],i.maxBytes.count=1):s===i.maxBytes.value&&(i.count<this.#i&&i.maxBytes.offset.push(l),i.maxBytes.count++),s<i.minBytes.value||i.minBytes.value===null?(i.minBytes.value=s,i.minBytes.offset=[l],i.minBytes.count=1):s===i.minBytes.value&&(i.count<this.#i&&i.minBytes.offset.push(l),i.minBytes.count++),t.depth>i.maxDepth.value||i.maxDepth.value===null?(i.maxDepth.value=t.depth,i.maxDepth.offset=[l],i.maxDepth.count=1):t.depth===i.maxDepth.value&&(i.count<this.#i&&i.maxDepth.offset.push(l),i.maxDepth.count++),t.depth>this.#t.maxDepth.value||this.#t.maxDepth.value===null?(this.#t.maxDepth.value=t.depth,this.#t.maxDepth.offset=[l],this.#t.maxDepth.count=1):t.depth===this.#t.maxDepth.value&&(this.#t.maxDepth.offset.length<this.#i&&this.#t.maxDepth.offset.push(l),this.#t.maxDepth.count++);i.depthCount.length<t.depth+1;)i.depthCount.push(0);i.depthCount[t.depth]++,t.annotationsLength>0&&(t.annotations.length>this.#t.maxAnnotations.value||this.#t.maxAnnotations.value===null?(this.#t.maxAnnotations.value=t.annotations.length,this.#t.maxAnnotations.offset=[l],this.#t.maxAnnotations.count=1):t.annotations.length===this.#t.maxAnnotations.value&&(this.#t.maxAnnotations.offset.length<this.#i&&this.#t.maxAnnotations.offset.push(l),this.#t.maxAnnotations.count++),this.trackElement({depth:t.depth,positionInStream:l,lengthWithoutAnnotations:t.annotationsLength,type:S.annotation,isNull:!1})),t.isNull===!0&&(this.#t.nulls.count++,this.#t.nulls[S.nameFromType(t.type)].count++)}combineStats(t){this.#t.nulls.count+=t.nulls.count,this.#t.topLevelCount+=t.topLevelCount,this.#t.maxDepth.value===t.maxDepth.value?(this.#t.maxDepth.offset=this.#t.maxDepth.offset.concat(t.maxDepth.offset),this.#t.maxDepth.count+=t.maxDepth.count):this.#t.maxDepth.value>t.maxDepth.value||this.#t.maxDepth.value<t.maxDepth.value&&(this.#t.maxDepth.offset=t.maxDepth.offset,this.#t.maxDepth.count=t.maxDepth.count,this.#t.maxDepth.value=t.maxDepth.value),this.#t.maxAnnotations.value===t.maxAnnotations.value?(this.#t.maxAnnotations.offset=this.#t.maxAnnotations.offset.concat(t.maxAnnotations.offset),this.#t.maxAnnotations.count+=t.maxAnnotations.count):this.#t.maxAnnotations.value>t.maxAnnotations.value||this.#t.maxAnnotations.value<t.maxAnnotations.value&&(this.#t.maxAnnotations.offset=t.maxAnnotations.offset,this.#t.maxAnnotations.count=t.maxAnnotations.count,this.#t.maxAnnotations.value=t.maxAnnotations.value);for(let e=0;e<S.numTypes;++e){let i=S.nameFromType(e);this.#t.nulls[i].count+=t.nulls[i].count,this.#t[i].byteCount+=t[i].byteCount;let s=this.#t[i],l=t[i];s.count+=l.count,s.maxBytes.value===l.maxBytes.value?(s.maxBytes.offset=s.maxBytes.offset.concat(l.maxBytes.offset),s.maxBytes.count+=l.maxBytes.count):s.maxBytes.value>l.maxBytes.value||s.maxBytes.value<l.maxBytes.value&&(s.maxBytes.offset=l.maxBytes.offset,s.maxBytes.count=l.maxBytes.count,s.maxBytes.value=l.maxBytes.value),s.minBytes.value===l.minBytes.value?(s.minBytes.offset=s.minBytes.offset.concat(l.minBytes.offset),s.minBytes.count+=l.minBytes.count):s.minBytes.value<l.minBytes.value||s.minBytes.value>l.minBytes.value&&(s.minBytes.offset=l.minBytes.offset,s.minBytes.count=l.minBytes.count,s.minBytes.value=l.minBytes.value);for(let r=0;r<l.depthCount.length;++r)s.depthCount.length===r&&s.depthCount.push(0),s.depthCount[r]+=l.depthCount[r];s.maxDepth.value===l.maxDepth.value?(s.maxDepth.offset=s.maxDepth.offset.concat(l.maxDepth.offset),s.maxDepth.count+=l.maxDepth.count):s.maxDepth.value>l.maxDepth.value||s.maxDepth.value<l.maxDepth.value&&(s.maxDepth.offset=l.maxDepth.offset,s.maxDepth.count=l.maxDepth.count,s.maxDepth.value=l.maxDepth.value)}}addSymbolTable(t){t.shared===!0?this.#t.symbolTable.shared.count++:t.append===!0?this.#t.symbolTable.append.count++:this.#t.symbolTable.local.count++}get stats(){return this.#t}};at.StructuralAnalyzer=ot});var pt=g(ht=>{"use strict";var f=I().IonTypes,we=w().IonElement,Se=q().SymbolTable,ve=P(),ut=D(),ft=class{#i;#t;#s;#e=t=>{let e=null;if(this.#s.length===0)return`$${t}`;if(e=this.#s[0].getSymbolValue(t),e!==void 0)return e;for(let i=1;i<this.#s.length;++i)if(e=this.#s[i].getSymbolValue(t),e!==void 0)return e};#l=t=>{let e=[];if(t.depth>0&&e.push(["Depth",t.depth,t.depth*2]),t.fieldNameVarUIntLength>0&&e.push(["Field name",`$${t.fieldNameSymbolID}`,t.fieldNameVarUIntLength*2]),t.annotationsLength>0){e.push(["Type","Annotation",1]),e.push(["Length",t.length-t.varUIntLengthWithAnnotations,1+t.varUIntLengthWithAnnotations*2]),e.push(["Length of Annotations",t.annotationsVarUIntLength,t.annotationsVarUIntLength*2]);for(let i=0;i<t.annotations.length;++i)e.push(["Annotation",`$${t.annotations[i].magnitude}`,t.annotations[i].numBytesRead*2])}return f.nameFromType(t.type)==="bvm"?(e.push(["Type",f.nameFromType(t.type),2]),e.push(["Major Version",1,2]),e.push(["Minor Version",0,2]),e.push(["BVM","End",2]),e):(e.push(["Type",f.nameFromType(t.type),1]),e.push(["Length",t.lengthWithoutAnnotations-t.varUIntLength,1+t.varUIntLength*2]),e)};#r=t=>{let e;if(t.isNull)return e=`null.${f.nameFromType(t.type)}`,(t.type===f["int+"]||t.type===f["int-"])&&(e="null.int"),e;if(t.isScalar){let i="";switch(t.bytePositionOfRepresentation===null?i=t.varUIntLength:i=ut.readScalarFromElement(t,this.#t),e=i,t.type){case f.bool:e=t.boolRepresentation;break;case f.string:e=`"${i}"`;break;case f.symbol:e=this.#e(i),e===void 0&&(e="$0");break;case f.decimal:i!==0?e=`${i.coefficient.magnitude}d${i.exponent.magnitude}`:e=i;break;case f.timestamp:e=`${i.year.magnitude}`,i.month!==void 0&&(e+=`-${i.month.magnitude}`),i.day!==void 0?(e+=`-${i.day.magnitude}T`,i.hour!==void 0&&(e+=`${i.hour.magnitude}:${i.minute.magnitude}`,i.second!==void 0&&(e+=`:${i.second.magnitude}`,i.fractionCoefficient!==void 0&&(e+=`.${i.fractionCoefficient.magnitude}`)))):e+="T",i.offset.isNegative===!1?e+=`+${i.offset.magnitude}`:e+=`-${i.offset.magnitude}`;break}}else if(t.isContainer)switch(t.type){case f.struct:e="{";break;case f.list:e="[";break;case f.sexp:e="(";break}else e="?";return e};#o=t=>{let e=new Array(4);if(e[0]=[null,"",t.depth*2],t.fieldNameSymbolID){let s=this.#e(t.fieldNameSymbolID);e[1]=[null,s,t.fieldNameVarUIntLength*2]}e[2]=[];for(let s=0;s<t.annotations.length;++s){let l=this.#e(t.annotations[s].magnitude);e[2].push([null,l,t.annotations[s].numBytesRead*2])}let i=t.positionInStream+t.totalLength-t.bytePositionOfRepresentation;return t.isScalar?t.bytePositionOfRepresentation!==null?e[3]=[null,this.#r(t),i*2]:e[3]=[null,this.#r(t),2]:e[3]=[null,this.#r(t),2],e};constructor(t,e,i){this.#i=t,this.#t=e,i!==void 0?this.#s=[...i]:this.#s=[]}printElementToString(t,e){let i="";for(let o=0;o<t.depth;++o)i+="\xB7";let s="";t.fieldNameSymbolID&&(s=this.#e(t.fieldNameSymbolID)+": ");let l="";for(let o=0;o<t.annotations.length;++o)l+=this.#e(t.annotations[o].magnitude)+"::";let r="",h="",y="";if(t.isNull)r=`null.${f.nameFromType(t.type)}`,(t.type===f["int+"]||t.type===f["int-"])&&(r="null.int");else if(t.isScalar){let o="";t.bytePositionOfRepresentation===null?o=t.varUIntLength:o=ut.readScalarFromElement(t,this.#t);let u=o;if(t.type===f.bool)u=`${t.boolRepresentation}`;else if(t.type===f.string)u=`"${o}"`;else if(t.type===f.symbol){let c=this.#e(o);c===void 0&&(c="$0"),u=`${c}`,y=` <${o}>`}else t.type===f.timestamp?(u=`${o.year.magnitude}`,o.month!==void 0&&(u+=`-${o.month.magnitude}`),o.day!==void 0?(u+=`-${o.day.magnitude}`,o.hour!==void 0?(u+=`T${o.hour.magnitude}:${o.minute.magnitude}`,o.second!==void 0&&(u+=`:${o.second.magnitude}`,o.fractionCoefficient!==void 0&&(u+=`.${o.fractionCoefficient.magnitude}`))):u+="T"):u+="T",o.offset.isNegative===!1?u+=`+${o.offset.magnitude}`:u+=`-${o.offset.magnitude}`):t.type===f.decimal&&o!==0&&(u=`${o.coefficient.magnitude}d${o.exponent.magnitude}`);r=`${u}`,h=` // scalar(${f.nameFromType(t.type)})`}else if(t.isContainer){let o="";t.type===f.struct?o="{":t.type===f.list?o="[":t.type===f.sexp&&(o="("),r=`${o}`,h=` // container(${f.nameFromType(t.type)})`}else r="?",h=` // special(${f.nameFromType(t.type)})`;let p="";t.depth!==0&&t.isContainer===!1&&(p=",");let E=`${t.isSystemElement===!0?" [system]":""}`;return`${i}${s}${l}${r}${p}${h}${y}${E}`}printContainerEndToString(t){if(!t.isContainer)throw new Error(`IonElementTextWriter printContainerEndToString(${f.nameFromType(t.type)})`);let e="";for(let l=0;l<t.depth;++l)e+="\xB7";let i="";t.type===f.struct?i="}":t.type===f.list?i="]":t.type===f.sexp&&(i=")");let s="";return t.depth!==0&&(s=","),`${e}${i}${s}`}printElementToAnnotatedString(t,e){let i="",s="",l=t.totalLength,r=`
 ${"".padStart(12," ")}| `,h=`${r}`,y="",p=this.#l(t),E="";for(let d=0;d<p.length;++d)E+=`${r}${y}+-> ${p[d][0]}: ${p[d][1]}`,y+="|".padEnd(p[d][2]," "),h+=`${"|".padEnd(p[d][2]-1,"-")}${p[d][2]>1?"\\":""}`;if(t.isContainer&&t.bytePositionOfRepresentation!==null&&(l=t.bytePositionOfRepresentation-t.positionInStream),l>e.length)throw new Error("IonElementTextWriter has invalid data.");for(let d=0;d<t.depth;++d)i+="\xB7\xB7";for(let d=0;d<l;++d)s+=`${e[d].toString(16).padStart(2,"0")}`;let o=`
 ${(""+t.positionInStream).padStart(12,"0")}| ${i}${s}`,u=this.#o(t),c="",m=`${r}`,x=0,v=null,A=null;if(m+="".padEnd(u[0][2]," "),u[1]!==void 0&&(m+="".padEnd(u[1][2],"!"),v=x,x+=u[1][2]),u[2].length>0){let d=(t.bytePositionOfAnnotations-t.positionInStream)*2-x;m+="".padEnd(d," "),x+=d,A=x;for(let F=0;F<u[2].length;++F)m+="".padEnd(u[2][F][2],"@"),x+=u[2][F][2]}let U=(t.bytePositionOfRepresentation-t.positionInStream)*2-x;t.bytePositionOfRepresentation===null&&(U=0),(t.isContainer||t.isNull)&&(U=(t.bytePositionOfRepresentation-t.positionInStream-1-t.varUIntLength)*2-x),x+=U,m+="".padEnd(U," "),m+="|",m+="".padEnd(u[3][2]-2,"-"),u[3][2]>1&&(m+="/"),c=`${r}${"".padEnd(u[0][2]," ")}`,c+=`${v!==null?"|":""}`,c+=`${A!==null?"".padEnd(A-(v!==null?1:0)," ")+"|"+"".padEnd(x-A-1):"".padEnd(v!==null?x-1:x," ")}`,c+=`+-> ${u[3][1]}`;let _="";A!==null&&(_+=`${r}${"".padEnd(u[0][2]," ")}`,_+=`${v!==null?"|":""}`,_+=`${"".padEnd(A-(v!==null?1:0)," ")+"+- "+u[2][0][1]+"::"}`);let C="";return v!==null&&(C+=`${r}${"".padEnd(u[0][2]," ")}`,C+=`+- ${u[1][1]}:`),`${E}${h}${o}${m}${c}${_}${C}
`}};ht.IonElementTextWriter=ft});var mt=g(yt=>{"use strict";var Ct=L(),Mt=P(),Wt=w().IonElement,Gt=q().SymbolTable,dt=D(),Xt=j().StructuralAnalyzer,gt=I().IonTypes,jt=pt().IonElementTextWriter,ct=class{#i;#t=0;#s;#e;#l;#r;#o;#u;#n;#a;#h=null;#p=function(){this.#u=[],this.#n=!1,this.#a=!1;for(let t=0;t<100;++t)this.#u.push(new Wt(0,0,this.#t,null,null,null));this.#h=this.#u[0]};constructor(t){if(t===void 0)throw new Error("ValueStreamReader passed an undefined reader.");if(this.#i=t,this.#t=this.#i.size,this.#s=new Ct.TypeDescriptorReader(this.#i),this.#e=new Mt.ScalarValueReader(this.#i),this.#r=new Gt(!0,!0,!0),this.#l=new Xt,this.#o=new jt(this.#s,this.#e,[this.#r]),this.#i.atEnd())throw new Error("TODO: empty file");this.#p()}readTopLevelTLPairs(t,e){let i=t,s=null,l=0,r=null;do{if(r=this.#s.readTypeAndLength(i),r===null)break;l=i,i=i+1+r.length}while(i<e);return l}readAll(){let t=this.#h;for(;;){this.#h=t;try{if(t.readTypeDescriptor(this.#s)===null)return t.length?t.length:100;this.#l.trackElement(t)}catch(e){throw console.log(`Error! currentElement: ${t.toString()}`),e}if((t.isLocalSymbolTable===!0||t.isSharedSymbolTable===!0)&&(this.#n=!0),this.#n===!0&&(t.depth===1&&t.fieldNameSymbolID===7?this.#a=!0:t.depth===2&&this.#a===!0&&t.type===gt.string&&this.#r.addSymbol(dt.readScalarFromElement(t,this.#e),t.positionInStream)),t.fieldNameSymbolID!==void 0&&this.#r.addUsage(t.fieldNameSymbolID,t.bytePositionOfRepresentation||t.positionInStream),t.type===gt.symbol){let e=t.bytePositionOfRepresentation===null?t.varUIntLength:dt.readScalarFromElement(t,this.#e);this.#r.addUsage(e,t.bytePositionOfRepresentation||t.positionInStream)}if(t.firstAnnotation!==null&&this.#r.addUsage(t.firstAnnotation.magnitude,t.positionInStream),t.isScalar&&!t.isNull&&t.lengthWithoutAnnotations!==0,t.isContainer&&!t.isNull&&t.length!==0){let e=t.containsElement;t=this.#u[e[1]],t.repurpose(e[0],e[1],e[2],e[3],e[4],e[5])}else if(t.nextElement)t.repurpose(t.nextElement[0],t.nextElement[1],t.nextElement[2],t.nextElement[3],t.nextElement[4],t.nextElement[5]);else{for(;t.depth>0&&(t=this.#u[t.depth-1],t.nextElement===null););if(this.#n===!0&&t.depth===0&&(this.#n=!1),this.#a===!0&&t.depth<2&&(this.#a=!1),t.nextElement)t.repurpose(t.nextElement[0],t.nextElement[1],t.nextElement[2],t.nextElement[3],t.nextElement[4],t.nextElement[5]);else{if(!this.#i.atEnd(t.positionInStream+t.totalLength))throw new Error("Not at end of stream");t=void 0;break}}}}};yt.ValueStreamReader=ct});var Et=g(bt=>{"use strict";var zt=T(),Re=mt(),Nt=class extends zt.ByteReader{#i;#t;#s=1;#e=-1;#l;#r;#o;#u;#n=t=>{};#a=0;#h=async()=>{let t=this.#i.slice(this.#e,this.#e+this.#s);this.#l=await this.#u(t),this.#r=new Uint8Array(this.#l)};#p=async(t,e)=>{let i=!1;this.#e===-1&&(this.#e=0,i=!0),e!==void 0?(i=!0,this.#e=e):(this.#a<this.#e||this.#a+t>=this.#e+this.#s-1)&&(i=!0,this.#e=this.#a),i&&await this.#h()};constructor(t){super();this.#o=new FileReader;let e=this;if(this.#u=i=>new Promise(l=>{e.#o.onloadend=r=>{l(e.#o.result),e.#n(r)},e.#o.readAsArrayBuffer(i)}),Number.isInteger(t)&&t>0)this.#s=t;else if(t!==void 0)throw new Error("ByteSliceReader constructor called with invalid bufferSize")}loadFile(t){if(!(t instanceof File))throw new Error(`ByteSliceReader loadFile() passed invalid filePath File ${t}.`);return this.#i=t,this.#t=t.size,this.#t}nextByte(){if(this.atEnd())return null;let t=this.#a-this.#e;if(t<0||this.#r===void 0||t>=this.#r.length)return null;let e=this.#r[t];if(e===void 0)throw new Error(`nextByte byte is undefined at ${t} and ${this.#a}`);return this.#a++,e}skipBytes(t){this.#a+=t}setPosition(t){this.#a=t}setBufferSize(t){if(Number.isInteger(t)&&t>0)this.#s=t;else if(t!==void 0)throw new Error(`ByteSliceReader setBufferSize called with invalid bufferSize ${t}`)}async fillBuffer(t,e){Number.isInteger(t)&&t>0&&t<=this.#s&&(this.setPosition(e),await this.#p(t,e))}atEnd(t){if(t===void 0&&(t=this.#a),t===this.#t)return!0;if(t>this.#t)throw new Error(`ByteSliceReader atEnd() asked to skip beyond end of file. ${t} > ${this.#t}`);return!1}get size(){return this.#t}get positionInFile(){return this.#a}get biBuffer(){return this.#l}get isReady(){let t=this.#o.readyState;return t===2||t===0}set readerOnLoadEndCallback(t){this.#n=t}rawBytes(t,e){return this.#r.slice(t-this.#e,t-this.#e+e)}};bt.ByteSliceReader=Nt});var Bt=g(xt=>{"use strict";var It=class{#i=null;constructor(t){this.#i=t}elementAt(t){return this.#i[t]}toArrays(){return this.#i}};xt.ElementStack=It});var St=g($t=>{"use strict";var De=L().TypeDescriptorReader,Ue=M().ByteBufferReader,_e=w().IonElement,Yt=D(),N=I().IonTypes,O=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],Zt=a=>{let t=new Array(Math.ceil(a.length*4/3));for(let e=0;e<a.length;e+=3){let i=a[e],s=a[e+1],l=a[e+2],r=a[e+3];if(t[e*4/3]=O[i>>>2],t[e*4/3+1]=O[i<<4&63|(s||0)>>>4],e+1<a.length)if(t[e*4/3+2]=O[s<<2&63|(l||0)>>>6],e+2<a.length)t[e*4/3+3]=O[l&63];else return t.join("")+"=";else return t.join("")+"=="}return t.join("")},wt=class{#i=[];#t=(t,e,i)=>{let s="";if(t.isNull)return s=`null.${N.nameFromType(t.type)}`,(t.type===N["int+"]||t.type===N["int-"])&&(s="null.int"),{representation:s,details:""};let l;if(t.isScalar){let r;switch(t.bytePositionOfRepresentation===null?r=t.varUIntLength:r=Yt.readScalarFromElement(t,e),s=r,t.type){case N.bool:s=t.boolRepresentation;break;case N.string:s=`${r}`;break;case N.symbol:s=`$${r}`,l=r;break;case N.decimal:r!==0?(s=`${r.coefficient.magnitude}d${r.exponent.magnitude}`,l=r):s=`${r}d0`;break;case N.timestamp:s=`${(""+r.year.magnitude).padStart(4,"0")}`,l=r,r.month!==void 0&&(s+=`-${(""+r.month.magnitude).padStart(2,"0")}`),r.day!==void 0?(s+=`-${(""+r.day.magnitude).padStart(2,"0")}T`,r.hour!==void 0&&(s+=`${(""+r.hour.magnitude).padStart(2,"0")}:${(""+r.minute.magnitude).padStart(2,"0")}`,r.second!==void 0&&(s+=`:${(""+r.second.magnitude).padStart(2,"0")}`,r.fractionCoefficient!==void 0&&(s+=`.${(""+r.fractionCoefficient.magnitude).padStart(-1*r.fractionExponent.magnitude,"0")}`)))):s+="T",r.offset.isNegative===!1?s+=`+${(""+Math.floor(r.offset.magnitude/60)).padStart(2,"0")}:${(""+r.offset.magnitude%60).padStart(2,"0")}`:Object.is(r.offset.magnitude,-0)&&(s+=`-${(""+Math.floor(-1*r.offset.magnitude/60)).padStart(2,"0")}:${(""+-1*r.offset.magnitude%60).padStart(2,"0")}`);break;case N.clob:s=`{{"${r}"}}`;break;case N.blob:if(t.length>0){let h=t.bytePositionOfRepresentation-t.positionInStream;s=`{{${Zt(i.subarray(h,i.length))}}}`}else s="{{}}";break}}else if(t.isContainer)switch(t.type){case N.struct:s="{";break;case N.list:s="[";break;case N.sexp:s="(";break}else switch(t.type){case N.bvm:s=`$ion_${t.majorVersion}_${t.minorVersion}`,l={major:t.majorVersion,minor:t.minorVersion};break;case N.nop:s=void 0;break;default:s="?";break}return{representation:s,details:l}};constructor(){this.#i=[]}inspectElement(t,e,i,s,l){let r=t.nibblePositionStruct;r.byteNibbles="";for(let y=0;y<e.length;++y)r.byteNibbles+=`${e[y].toString(16).padStart(2,"0")}`;let h=this.#t(t,i,e);if(r.nibblesToDisplay=s*2,r.element.representation=h.representation,r.element.details=h.details,r.offset+=l,r.isSystemElement=t.isSystemElement,r.containersToClose=[],t.isContainer&&r.element.lengthValue===0&&!t.isNull&&(r.containersToClose.push(r.element.typeName),r.isZeroLengthContainer=!0),t.depth>0&&(r.parentOffset=t.container+l,t.bytesRemainingAtDepth===t.totalLength&&!(t.isContainer&&r.element.lengthValue!==0))){r.isLastElementAtDepth=!0;let y=t.depth,p=r.parentOffset,E=r.offset+r.element.totalLength;for(let o=this.#i.length-1;o>=0;--o)if(this.#i[o].offset===p)if(this.#i[o].offset+this.#i[o].element.totalLength===E){if(r.containersToClose.push(this.#i[o].element.typeName),y--,y===0)break;p=this.#i[o].parentOffset}else break}this.#i.push(r)}get nibblesToDisplay(){return this.#i}};$t.Inspector=wt});var At=g(vt=>{"use strict";var{IonElement:Pe}=w(),{IonTypes:qe}=I(),k=class{static verifyStack(t){if(!(!Array.isArray(t)||t.length===0)){if(t[0][6]!==void 0){if(t[0][6]>t[0][0]+t[0][1]+t[0][3])throw new Error(`Verifier| (i:0) ${t[0][6]} > ${t[0][0]+t[0][1]+t[0][3]}`);if(t[0][6]<t[0][0]+t[0][1]+1)throw new Error(`Verifier| (i:0) ${t[0][6]} < ${t[0][0]+t[0][1]+1}`)}for(let e=1;e<t.length;++e){if(t[e-1][2]!==t[e][2]-1)throw new Error(`Verifier| ${t[e-1][2]} !== ${t[e][2]}-1`);let i,s;t[e-1][6]!==void 0?(i=t[e-1][6],s=!0):(i=t[e-1][0]+t[e-1][1]+t[e-1][3],s=!1);let l=t[e][0]+t[e][1]+t[e][3];if(l!==i)throw new Error(`Verifier| (i:${e}) ${l} !== ${i} (i-1) ${s?"(next)":"(absolute)"}`);if(t[e][6]!==void 0){if(t[e][6]>l)throw new Error(`Verifier| (i:${e}) ${t[e][6]} > ${l}`);if(t[e][6]<t[e][0]+t[e][1]+1)throw new Error(`Verifier| (i:${e}) ${t[e][6]} < ${t[e][0]+t[e][1]+1}`)}if(t[e][4]!==t[e-1][0]+t[e-1][1])throw new Error(`Verifier| ${t[e]} !== ${t[e-1]} container(4)`)}}}#i=[];#t=null;#s=0;#e=0;#l=!1;#r=!1;constructor(t,e,i=!1,s=!1){this.#t=[];for(let l of t)this.#t.push(l.reference());k.verifyStack(this.#t),this.#s=e,this.#l=i,this.#r=s}verifyElement(t){let e=this.#t[this.#t.length-1];if(e!==void 0){let i=t[0]+t[1]-(e[0]+e[1]);this.#e+=i}else this.#e+=t[1];if(this.#e>this.#s)throw new Error(`Verifier| ${this.#e} > ${this.anticipatedBytes}`);this.#t.push(t)}atEnd(t){if(this.#e+=t,this.#r===!0&&this.#e!==this.#s)throw new Error(`Verifier| ${this.#e} !== ${this.#s}`)}get elementLog(){return this.#t}};vt.Verifier=k});var Rt=g((ke,Tt)=>{"use strict";var Ht=M().ByteBufferReader,Jt=T().ByteReader,Kt=Et().ByteSliceReader,Qt=G().ElementReference,te=Bt().ElementStack,ee=w().IonElement,ie=I().IonTypes,ne=D(),se=P().ScalarValueReader,le=q().SymbolTable,re=L().TypeDescriptorReader,ae=j().StructuralAnalyzer,oe=St().Inspector,he=At().Verifier;Tt.exports={ByteBufferReader:Ht,ByteReader:Jt,ByteSliceReader:Kt,ElementReference:Qt,ElementStack:te,IonElement:ee,IonTypes:ie,utilities:ne,ScalarValueReader:se,SymbolTable:le,TypeDescriptorReader:re,Inspector:oe,Analyzer:ae,Verifier:he}});return Rt();})();
